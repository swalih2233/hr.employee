<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Holidays</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
</head>

<body class="bg-gray-100 text-gray-800 font-sans" x-data="pageData()" x-cloak>

<!-- ===================== NAVBAR ===================== -->
<nav class="bg-[#1F2937] text-white px-4 py-3 shadow relative">
    <div class="max-w-7xl mx-auto flex items-center justify-between">

        <!-- LOGO -->
        <a href="{% url 'managers:founder_dashboard' %}" class="flex items-center">
            <img src="/static/images/White Transparent Mavendoer.png" 
                 alt="Logo" 
                 class="h-[30px] w-auto object-contain sm:h-[40px]">
        </a>

        <!-- DESKTOP MENU -->
        <div class="hidden md:flex items-center space-x-6 text-sm">
            <a href="{% url 'managers:founder_dashboard' %}" class="hover:underline">Dashboard</a>
            <a href="{% url 'managers:holidays_list' %}" class="hover:underline font-bold">Holidays</a>
            <a href="{% url 'managers:employees_list' %}" class="hover:underline">Employees</a>
            <a href="{% url 'managers:logout' %}" class="hover:underline">Sign Out</a>
        </div>

        <!-- MOBILE HAMBURGER -->
        <button class="block md:hidden" @click="sidebarOpen=true">
            <i class="fa fa-bars text-xl"></i>
        </button>
    </div>
</nav>

<!-- ========== MOBILE SLIDE-IN NAV DRAWER ========== -->
<div 
    x-show="sidebarOpen"
    @click="sidebarOpen=false"
    class="fixed inset-0 bg-black bg-opacity-50 md:hidden z-40">
</div>

<aside 
    x-show="sidebarOpen"
    class="fixed top-0 right-0 h-full w-64 bg-[#1F2937] text-white z-50 p-6 md:hidden transform transition-all"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="translate-x-full"
    x-transition:enter-end="translate-x-0"
    x-transition:leave="transition ease-in duration-300"
    x-transition:leave-start="translate-x-0"
    x-transition:leave-end="translate-x-full">

    <!-- Close button -->
    <button class="absolute top-4 right-4" @click="sidebarOpen=false">
        <i class="fa fa-times text-2xl"></i>
    </button>

    <h3 class="text-xl font-semibold mt-8 mb-6">Menu</h3>

    <nav class="flex flex-col space-y-4 text-base">
        <a href="{% url 'managers:founder_dashboard' %}" class="hover:underline">Dashboard</a>
        <a href="{% url 'managers:holidays_list' %}" class="hover:underline font-bold">Holidays</a>
        <a href="{% url 'managers:employees_list' %}" class="hover:underline">Employees</a>
        <a href="{% url 'managers:logout' %}" class="hover:underline text-red-300">Sign Out</a>
    </nav>
</aside>

<!-- ===================== MAIN CONTENT ===================== -->
<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-10">
    <section class="bg-white rounded-lg shadow">
        <div class="flex justify-between items-center px-6 py-4 border-b border-gray-200">
            <h2 class="text-base font-semibold">Holidays List</h2>
            <button @click.prevent="openSidebar('addHoliday')" 
                    class="text-sm text-white bg-[#1F2937] hover:bg-[#1F2938] px-4 py-2 rounded-lg">
                Add Holiday
            </button>
        </div>

        <div class="overflow-x-auto">
            <table class="min-w-full text-sm text-left text-gray-700">
                <thead class="bg-gray-50 text-xs text-gray-500 uppercase">
                    <tr>
                        <th class="px-6 py-3">Holiday Name</th>
                        <th class="px-6 py-3">Date</th>
                        <th class="px-6 py-3">Day</th>
                        <th class="px-6 py-3">Actions</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-200">
                    {% for holiday in holidays %}
                    <tr>
                        <td class="px-6 py-4">{{ holiday.title }}</td>
                        <td class="px-6 py-4">{{ holiday.date|date:"d M Y" }}</td>
                        <td class="px-6 py-4">{{ holiday.date|date:"l" }}</td>
                        <td class="px-6 py-4">
                            <form method="post" action="{% url 'managers:delete_holiday' holiday.id %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="text-red-600 hover:text-red-900" onclick="return confirm('Are you sure you want to delete this holiday?')">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="4" class="text-center py-6 text-gray-500">No holidays found.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </section>
</div>

<!-- ========== ADD HOLIDAY SIDEBAR FORM ========== -->
<div x-show="isSidebarOpen('addHoliday')" class="fixed inset-0 overflow-hidden z-50">
    <div class="absolute inset-0 overflow-hidden">
        <div x-show="isSidebarOpen('addHoliday')" 
             @click="closeSidebar()" 
             class="absolute inset-0 bg-gray-500 bg-opacity-75 transition-opacity"></div>

        <section class="absolute inset-y-0 right-0 pl-10 max-w-full flex">
            <div x-show="isSidebarOpen('addHoliday')" class="w-screen max-w-md">
                <div class="h-full flex flex-col bg-white shadow-xl">

                    <div class="py-6 px-4 bg-gray-800 sm:px-6 flex items-center justify-between">
                        <h2 class="text-lg font-medium text-white">Add Holiday</h2>
                        <button @click="closeSidebar()" class="rounded-md text-gray-300 hover:text-white">
                            <i class="fa fa-times text-xl"></i>
                        </button>
                    </div>

                    <div class="relative flex-1 py-6 px-4 sm:px-6">
                        <form method="POST" action="{% url 'managers:add_holiday' %}" class="space-y-4">
                            {% csrf_token %}
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Holiday Name *</label>
                                <input type="text" name="title" required class="mt-1 block w-full border border-gray-300 rounded-lg p-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700">Date *</label>
                                <input type="date" name="date" required class="mt-1 block w-full border border-gray-300 rounded-lg p-2">
                            </div>
                            <div class="flex justify-end">
                                <button type="button" @click="closeSidebar()" class="mr-2 px-4 py-2 rounded-lg border">Cancel</button>
                                <button type="submit" class="px-4 py-2 rounded-lg bg-[#1F2937] text-white">Add</button>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </section>
    </div>
</div>

<!-- ===================== JAVASCRIPT ===================== -->
<script>
function pageData() {
    return {
        activeSidebar: null,
        sidebarOpen: false,

        openSidebar(name){ this.activeSidebar = name },
        closeSidebar(){ this.activeSidebar = null },
        isSidebarOpen(name){ return this.activeSidebar === name }
    }
}
</script>

</body>
</html>
