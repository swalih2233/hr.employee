{% extends "base/base.html" %}
{% block container %}
{% load static %}

{% include 'includes/employee-nav.html' %}

<div class="p-4 max-w-lg mx-auto pt-[15vh]">
    <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-2xl font-semibold mb-4 text-center">Leave Application Form</h2>
        
        {% if leave_balance_info.is_cf_period and leave_balance_info.carryforward_available_leaves > 0 %}
        <div class="mb-4 p-3 bg-yellow-50 border-l-4 border-yellow-400 text-yellow-700 text-sm">
            <p class="font-bold">Carry-Forward Leaves Available: {{ leave_balance_info.carryforward_available_leaves }}</p>
            <p>These leaves will be automatically used first for Annual Leave and expire on March 31st.</p>
        </div>
        {% endif %}

        <form method="post" enctype="multipart/form-data" action="{% url 'employe:apply_leave' %}">
            {% csrf_token %}
            
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="subject">Subject</label>
                <input type="text" name="subject" id="subject" required
                       class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
            </div>

            <div class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="start_date">Start Date</label>
                    <input type="date" name="start_date" id="start_date" required
                           class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
                <div>
                    <label class="block text-gray-700 text-sm font-bold mb-2" for="end_date">End Date</label>
                    <input type="date" name="end_date" id="end_date" required
                           class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                </div>
            </div>

            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="leave_type">Leave Type</label>
                <select name="leave_type" id="leave_type" required
                        class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                    <option value="AL">Annual Leave</option>
                    <option value="ML">Medical Leave</option>
                </select>
                <p class="text-[10px] text-gray-400 mt-1 italic">* For Annual Leave in Q1, carry-forward days are used first.</p>
            </div>

            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="description">Description</label>
                <textarea name="description" id="description" rows="3" required
                          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
            </div>

            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="file">Attachment (Optional)</label>
                <input type="file" name="file" id="file"
                       class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
            </div>
            
            <!-- Submit Button -->
            <div class="text-center">
                <button type="submit"
                        class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50">
                    Submit Application
                </button>
            </div>
        </form>
    </div>
</div>

{% endblock %}
